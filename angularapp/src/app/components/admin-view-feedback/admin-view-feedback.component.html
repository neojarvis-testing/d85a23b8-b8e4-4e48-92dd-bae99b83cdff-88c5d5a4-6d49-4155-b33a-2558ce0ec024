
<head></head>
<body style="background-color: black;">

<div class="container mt-4">
    <h2 class="text-center mb-4">Feedback Received</h2>

    <!-- Dropdown for filtering feedback by category -->
    <div class="mb-3">
        <label for="categoryFilter" class="form-label">Filter by Category:</label>
        <select id="categoryFilter" class="form-select" [(ngModel)]="selectedCategory" (change)="filterByCategory()">
            <option value="All">All Categories</option>
            <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
        </select>
    </div>

    <!-- Feedback table -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped" *ngIf="filteredFeedbacks.length > 0">
            <thead class="table-dark">
                <tr>
                    <th>S.No.</th>
                    <th>User Name</th>
                    <th>Feedback</th>
                    <th>Posted Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let feedback of filteredFeedbacks; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ feedback.user.username }} | {{feedback.user.userId}}</td>
                    <td>{{ feedback.feedbackText }}</td>
                    <td>{{ feedback.date | date:'dd-MM-yyyy' }}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" (click)="showUserDetails(feedback.user.userId)">Show Profile</button>
                        <button class="btn btn-info btn-sm" (click)="showPropertyDetails(feedback.property.propertyId)">View Property Info</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- No feedback found message -->
    <div *ngIf="filteredFeedbacks.length === 0" class="alert alert-warning text-center">
        No Feedbacks Found
    </div>

    <!-- Modal for user details -->
    <div *ngIf="selectedUser" class="modal fade show d-block" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h3 class="modal-title">User Details</h3>
                    <button type="button" class="btn-close" (click)="closeUserDetails()">X</button>
                </div>
                <div class="modal-body">
                    <p><strong>Username:</strong> {{ selectedUser.username }}</p>
                    <p><strong>Email:</strong> {{ selectedUser.email }}</p>
                    <!-- <p><strong>Mobile Number:</strong> {{ selectedUser.mobileNumber}}</p> -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for property details -->
    <div *ngIf="selectedProperty" class="modal fade show d-block" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h3 class="modal-title">Property Details</h3>
                    <button type="button" class="btn-close" (click)="closePropertyDetails()">X</button>
                </div>
                <div class="modal-body">
                    <p><strong>Title:</strong> {{ selectedProperty.title }}</p>
                    <p><strong>Location:</strong> {{ selectedProperty.location }}</p>
                    <p><strong>Price:</strong> {{ selectedProperty.price | currency }}</p>
                    <p><strong>Description:</strong> {{ selectedProperty.description }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
    
</body>
